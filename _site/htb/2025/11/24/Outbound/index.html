<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Outbound | DuckP0nd</title>
  <meta name="description" content="Cybersecurity Protfolio">
  <link rel="stylesheet" href="/assets/css/main.css">
  <script src="/assets/js/main.js"></script>
</head>
<body>
  <!-- Navigation -->
  <nav class="nav">
    <div class="nav__container">
      <a href="/" class="nav__logo">DuckP0nd</a>
      
      <!-- Desktop Navigation -->
      <ul class="nav__menu">
        <li><a href="/" class="nav__link">Home</a></li>
        <li><a href="/htb.html" class="nav__link">HTB Write-ups</a></li>
        <li><a href="/blog.html" class="nav__link">Blog</a></li>
      </ul>

      <!-- Mobile Menu Toggle -->
      <button class="nav__toggle" aria-label="Toggle navigation menu">
        <span class="nav__toggle-icon"></span>
        <span class="nav__toggle-icon"></span>
        <span class="nav__toggle-icon"></span>
      </button>
    </div>

    <!-- Mobile Navigation -->
    <div class="nav__mobile">
      <ul class="nav__mobile-menu">
        <li><a href="/" class="nav__mobile-link">Home</a></li>
        <li><a href="/htb.html" class="nav__mobile-link">HTB Write-ups</a></li>
        <li><a href="/blog.html" class="nav__mobile-link">Blog</a></li>
      </ul>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="main">
    <article class="post">
  <div class="container container--post">
    
    <!-- Breadcrumb Navigation -->
    <nav class="breadcrumb" aria-label="Breadcrumb">
      <ol class="breadcrumb__list">
        <li class="breadcrumb__item">
          <a href="/" class="breadcrumb__link">Home</a>
        </li>
        <li class="breadcrumb__item">
          
            <a href="/htb.html" class="breadcrumb__link">HTB Write-ups</a>
          
        </li>
        <li class="breadcrumb__item breadcrumb__item--active">
          Outbound
        </li>
      </ol>
    </nav>

    <!-- Post Header -->
    <header class="post-header">
      <h1 class="post-title">Outbound</h1>
      
      <div class="post-meta">
        <time class="post-date">November 24, 2025</time>
        
        
          <span class="badge badge--easy">Easy</span>
        
        
        
          <span class="badge">Linux</span>
        
        
        
      </div>

      
        <div class="post-tags">
          
            <span class="tag">CVE</span>
          
            <span class="tag">SQL</span>
          
            <span class="tag">Cryptograohy</span>
          
        </div>
      
    </header>

      <!-- Post Content -->
    <div class="post-content">
      <p>![[HTB-banner.png]]
![[PWNED.png]]</p>
<div style="page-break-after: always;"></div>

<h1 id="description"><strong>Description:</strong></h1>
<p>Outbound is an easy Linux box that utilizes two known exploits.</p>

<h4 id="difficultyeasy">Difficulty:<code class="language-plaintext highlighter-rouge">Easy</code>
</h4>
<h4 id="operating-system-linux">Operating System: <code class="language-plaintext highlighter-rouge">Linux</code>
</h4>

<h4 id="default-creds-tyler--lhkl1o9nm3x2">Default Creds: <code class="language-plaintext highlighter-rouge">tyler / LhKL1o9Nm3X2</code>
</h4>

<h1 id="skills-required"><strong>Skills Required:</strong></h1>
<ul>
  <li>Linux file system understanding</li>
  <li>Basic SQL commands</li>
  <li>Basic understanding of decryption techniques
    <h1 id="tools-used"><strong>Tools Used:</strong></h1>
  </li>
  <li>nmap</li>
  <li>netcat</li>
  <li>ssh</li>
</ul>
<div style="page-break-after: always;"></div>
<h1 id="enumeration"><strong>Enumeration</strong></h1>
<hr>
<h2 id="port-scanning---nmap">Port Scanning - Nmap</h2>
<hr>
<p>![[nmap-enum.png]]
On the nmap scan we see two open ports, one of which is a website running on port 80, the other is ssh on port 22.</p>
<div style="page-break-after: always;"></div>

<p>![[Roundcube login.png]]
Here we are greeted with a login page which we can put the default credentials into. Upon logging in, Roundcube Webmail looks like a normal email client.</p>

<p>![[version-vuln.png]]
Upon looking around, we notice that Roundcube Webmail is out of date. (Current version as of writing is 1.6.11) Because of this, we can search for known vulnerabilities. That is linked below. Also linked is the website revshells. This website will create a custom payload for your attack.
https://github.com/fearsoff-org/CVE-2025-49113
https://www.revshells.com/</p>

<div style="page-break-after: always;"></div>

<h1 id="foothold"><strong>Foothold</strong></h1>
<hr>
<h2 id="user-enumeration">User Enumeration</h2>
<hr>
<p>![[CVE-2025-49113.png]]
![[nc listener.png]]
After running the payload we have a reverse shell as www-data. Because there is a login page, I wanted to see if there was a database storing user credentials. I navigated to the directory <code class="language-plaintext highlighter-rouge">/var/www/html/roundcube</code>. The config directory here is home to a few PHP files, one of which is interesting. We will be looking at config.inc.php.</p>

<p>![[php-config.png]]
There are two important pieces of information in this file. The first of which is highlighted in green, and shows the database’s username and password. Second, highlighted in pink, is an encryption key used for passwords.</p>

<p>With the credentials we now have, we should be able to query the database to try and find a vulnerable user.</p>

<p>![[session-lookup-encoded.png]]
When viewing the session table, we are met with a large base64 encoded string, lets decode it.</p>

<p>![[decoded-session.png]]
In this decoded text blob there are two important pieces of information. We have a user called “jacob” and we have an encrypted password for jacob.</p>

<p>To decrypt this password we need some sort of script. I chose this one:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">DES3</span>
<span class="kn">import</span> <span class="n">base64</span>

<span class="n">des_key</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">rcmail-!24ByteDESkey*Str</span><span class="sh">'</span>
<span class="n">encrypted_b64</span> <span class="o">=</span> <span class="sh">"</span><span class="s">L7Rv00A8TuwJAr67kITxxcSgnIk25Am/</span><span class="sh">"</span>

<span class="n">encrypted_bytes</span> <span class="o">=</span> <span class="n">base64</span><span class="p">.</span><span class="nf">b64decode</span><span class="p">(</span><span class="n">encrypted_b64</span><span class="p">)</span>
<span class="n">iv</span> <span class="o">=</span> <span class="n">encrypted_bytes</span><span class="p">[:</span><span class="mi">8</span><span class="p">]</span>
<span class="n">ciphertext</span> <span class="o">=</span> <span class="n">encrypted_bytes</span><span class="p">[</span><span class="mi">8</span><span class="p">:]</span>
<span class="n">cipher</span> <span class="o">=</span> <span class="n">DES3</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">des_key</span><span class="p">,</span> <span class="n">DES3</span><span class="p">.</span><span class="n">MODE_CBC</span><span class="p">,</span> <span class="n">iv</span><span class="p">)</span>
<span class="n">decrypted_bytes</span> <span class="o">=</span> <span class="n">cipher</span><span class="p">.</span><span class="nf">decrypt</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">unpad</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">s</span><span class="p">[:</span><span class="o">-</span><span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Decrypted password:</span><span class="sh">"</span><span class="p">,</span> <span class="nf">unpad</span><span class="p">(</span><span class="n">decrypted_bytes</span><span class="p">).</span><span class="nf">decode</span><span class="p">())</span>
</code></pre></div></div>
<p>It utilizes the key we found earlier, along with some base64, to decrypt the password for jacob.</p>

<p>![[jacob-passwd.png]]
This password does not work for ssh as jacob, however we can switch users in the reverse shell.</p>

<p>![[su-jacob.png]]
Navigating to <code class="language-plaintext highlighter-rouge">/home/jacob/mail</code> we can see the mail inbox for jacob. If we read the only piece of mail in there, we are given another password for jacob.</p>

<p>![[jacob-ssh-passwd.png]]
This password lets us ssh as jacob and get the user flag.</p>

<p>![[user-flag.png]]</p>
<div style="page-break-after: always;"></div>

<h2 id="privilege-escalation">Privilege Escalation</h2>
<hr>
<p>![[sudo-l.png]]
Looking at what jacob can run as sudo, we see that he has access to the system data monitoring and recording tool Below.</p>

<p>The version of Below running is vulnerable to CVE-2025-27591, which is linked here:
https://github.com/BridgerAlderson/CVE-2025-27591-PoC</p>

<p>![[python-server.png]]</p>

<p>![[wget.png]]
After downloading the exploit on our local machine, we make a python server so that we can download the exploit onto the vulnerable machine using wget.</p>

<p>![[get-pwned-kid.png]]
After giving the exploit execute privileges, we run the command. We now have root.</p>

<p>![[root-flag.png]]</p>

    </div>
    
    <!-- Previous/Next Navigation -->
    <nav class="post-navigation">
      
      
      
    </nav>

  </div>
</article>

<style>
/* Post Container */
.container--post {
  max-width: 1200px;
}

/* Breadcrumb */
.breadcrumb {
  margin-bottom: var(--space-xl);
  padding: var(--space-md) 0;
}

.breadcrumb__list {
  display: flex;
  flex-wrap: wrap;
  list-style: none;
  padding: 0;
  margin: 0;
  gap: var(--space-sm);
  align-items: center;
}

.breadcrumb__item {
  display: flex;
  align-items: center;
  font-size: 0.875rem;
}

.breadcrumb__item:not(:last-child)::after {
  content: '›';
  margin-left: var(--space-sm);
  color: var(--color-text-muted);
}

.breadcrumb__link {
  color: var(--color-text-secondary);
  text-decoration: none;
  transition: color var(--transition-fast);
}

.breadcrumb__link:hover {
  color: var(--color-accent);
}

.breadcrumb__item--active {
  color: var(--color-text-muted);
}

/* Post Header */
.post-header {
  text-align: center;
  padding: var(--space-2xl) 0;
  border-bottom: 1px solid var(--color-border);
  margin-bottom: var(--space-3xl);
}

.post-title {
  font-size: 2.5rem;
  margin-bottom: var(--space-lg);
  line-height: 1.2;
}

.post-meta {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: var(--space-md);
  flex-wrap: wrap;
  margin-bottom: var(--space-md);
}

.post-date {
  color: var(--color-text-muted);
  font-size: 0.875rem;
}

.post-tags {
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  gap: var(--space-sm);
}

/* Post Layout */
.post-layout {
  display: grid;
  grid-template-columns: 250px 1fr;
  gap: var(--space-3xl);
  align-items: start;
}

/* Sidebar */
.post-sidebar {
  position: sticky;
  top: var(--space-xl);
}

.toc-wrapper,
.share-wrapper {
  margin-bottom: var(--space-2xl);
}

.toc-title,
.share-title {
  font-size: 0.875rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  color: var(--color-text-muted);
  margin-bottom: var(--space-md);
}

/* Table of Contents */
.toc-list {
  list-style: none;
  padding: 0;
  margin: 0;
}

.toc-item {
  margin-bottom: var(--space-sm);
}

.toc-item--sub {
  margin-left: var(--space-md);
  font-size: 0.875rem;
}

.toc-link {
  color: var(--color-text-secondary);
  text-decoration: none;
  transition: color var(--transition-fast);
  font-size: 0.875rem;
  line-height: 1.6;
}

.toc-link:hover {
  color: var(--color-accent);
}

/* Share Buttons */
.share-buttons {
  display: flex;
  flex-direction: column;
  gap: var(--space-sm);
}

.share-btn {
  display: flex;
  align-items: center;
  gap: var(--space-sm);
  padding: var(--space-sm) var(--space-md);
  background-color: var(--color-bg-secondary);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-md);
  color: var(--color-text-secondary);
  cursor: pointer;
  transition: all var(--transition-fast);
  font-size: 0.875rem;
  text-align: left;
}

.share-btn:hover {
  border-color: var(--color-accent);
  color: var(--color-accent);
}

.share-btn svg {
  width: 16px;
  height: 16px;
  flex-shrink: 0;
}

.post-content {  
  max-width: 800px;
  margin-left: auto;
  margin-right: auto;
  display: block;   
}

.post-content h2 {
  margin-top: var(--space-2xl);
  padding-top: var(--space-lg);
  border-top: 1px solid var(--color-border);
}

.post-content h2:first-child {
  margin-top: 0;
  padding-top: 0;
  border-top: none;
}

.post-content h3 {
  margin-top: var(--space-xl);
}

.post-content img {
  max-width: 100%;
  height: auto;
  border-radius: var(--radius-md);
  margin: var(--space-xl) 0;
}

.post-content pre {
  background-color: var(--color-bg-tertiary);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-md);
  padding: var(--space-lg);
  overflow-x: auto;
  margin: var(--space-xl) 0;
}

.post-content code {
  font-family: 'Courier New', Courier, monospace;
  font-size: 0.875rem;
  background-color: var(--color-bg-tertiary);
  padding: 2px 6px;
  border-radius: var(--radius-sm);
}

.post-content pre code {
  background: none;
  padding: 0;
}

.post-content blockquote {
  border-left: 4px solid var(--color-accent);
  padding-left: var(--space-lg);
  margin: var(--space-xl) 0;
  color: var(--color-text-secondary);
  font-style: italic;
}

/* Post Navigation */
.post-navigation {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: var(--space-xl);
  margin-top: var(--space-3xl);
  padding-top: var(--space-2xl);
  border-top: 1px solid var(--color-border);
}

.post-nav-link {
  display: flex;
  flex-direction: column;
  padding: var(--space-lg);
  background-color: var(--color-bg-secondary);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-md);
  text-decoration: none;
  transition: all var(--transition-fast);
}

.post-nav-link:hover {
  border-color: var(--color-accent);
  transform: translateY(-2px);
}

.post-nav-link--next {
  text-align: right;
  margin-left: auto;
}

.post-nav-label {
  font-size: 0.75rem;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  color: var(--color-text-muted);
  margin-bottom: var(--space-xs);
}

.post-nav-title {
  color: var(--color-text-primary);
  font-weight: 500;
}

/* Responsive */
@media (max-width: 1024px) {
  .post-layout {
    grid-template-columns: 1fr;
  }
  
  .post-sidebar {
    position: static;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--space-xl);
  }
}

@media (max-width: 768px) {
  .post-title {
    font-size: 2rem;
  }
  
  .post-sidebar {
    grid-template-columns: 1fr;
  }
  
  .post-navigation {
    grid-template-columns: 1fr;
  }
  
  .post-nav-link--next {
    margin-left: 0;
    text-align: left;
  }
}
</style>

<script>
// Share Functions
function shareOnTwitter() {
  const url = window.location.href;
  const text = document.querySelector('.post-title').textContent;
  window.open(`https://twitter.com/intent/tweet?url=${encodeURIComponent(url)}&text=${encodeURIComponent(text)}`, '_blank');
}

function shareOnLinkedIn() {
  const url = window.location.href;
  window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(url)}`, '_blank');
}

function copyLink() {
  const url = window.location.href;
  navigator.clipboard.writeText(url).then(() => {
    const btn = document.querySelector('.share-btn--copy');
    const originalText = btn.innerHTML;
    btn.innerHTML = `
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="20 6 9 17 4 12"></polyline>
      </svg>
      Copied!
    `;
    btn.style.color = 'var(--color-success)';
    
    setTimeout(() => {
      btn.innerHTML = originalText;
      btn.style.color = '';
    }, 2000);
  }).catch(err => {
    console.error('Failed to copy:', err);
  });
}
</script>

  </main>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer__container">
      <!-- Social Links -->
      <div class="footer__social">
        <a href="https://github.com/Curran-Hill" target="_blank" rel="noopener noreferrer" class="footer__link" aria-label="GitHub">
          <svg class="footer__icon" viewbox="0 0 24 24" fill="currentColor">
            <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path>
          </svg>
        </a>
        <a href="https://linkedin.com/in/curran-hill" target="_blank" rel="noopener noreferrer" class="footer__link" aria-label="LinkedIn">
          <svg class="footer__icon" viewbox="0 0 24 24" fill="currentColor">
            <path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"></path>
          </svg>
        </a>
        <a href="https://app.hackthebox.com/users/2121810" target="_blank" rel="noopener noreferrer" class="footer__link" aria-label="Hack The Box">
          <svg class="footer__icon" viewbox="0 0 24 24" fill="currentColor">
            <path d="M11.996 0L1.122 6.02v11.959l10.874 6.021 10.874-6.021V6.021L11.996 0zm9.458 16.921l-9.458 5.239-9.458-5.239V7.079l9.458-5.239 9.458 5.239v9.842z"></path>
            <path d="M11.996 4.675L6.818 7.5v5.65l5.178 2.825 5.178-2.825V7.5l-5.178-2.825zm3.59 8.05l-3.59 1.959-3.59-1.959V8.925l3.59-1.959 3.59 1.959v3.8z"></path>
          </svg>
        </a>
        <a href="mailto:curran.hill@protonmail.com" class="footer__link" aria-label="Email">
          <svg class="footer__icon" viewbox="0 0 24 24" fill="currentColor">
            <path d="M0 3v18h24v-18h-24zm21.518 2l-9.518 7.713-9.518-7.713h19.036zm-19.518 14v-11.817l10 8.104 10-8.104v11.817h-20z"></path>
          </svg>
        </a>
      </div>

      <!-- Copyright -->
      <div class="footer__copyright">
        <p>© 2025 DuckP0nd. All rights reserved.</p>
        <p class="footer__quack">Quack!</p>
      </div>
    </div>
  </footer>

  <script src="/assets/js/main.js"></script>
</body>
</html>
